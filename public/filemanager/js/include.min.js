function create_text_file(){$("#textfile_create_area").parent().parent().remove();var e=$("#lang_filename").val()+': <input type="text" id="create_text_file_name" style="min-height:30px"><br><hr><textarea id="textfile_create_area" style="width:100%;height:150px;"></textarea>';bootbox.dialog(e,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#create_text_file_name").val();var t=$("#textfile_create_area").val();if(e!==null){e=fix_filename(e);var n=$("#sub_folder").val()+$("#fldr_value").val()+e;var r=$("#cur_dir_thumb").val()+e;$.ajax({type:"POST",url:"execute.php?action=create_file",data:{path:n,path_thumb:r,name:e,new_content:t}}).done(function(e){if(e!=""){bootbox.alert(e,function(e){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)})}})}}}],{header:$("#lang_new_file").val()})}function edit_text_file(e){$("#textfile_edit_area").parent().parent().remove();var t=e.find(".rename-file").attr("data-thumb");var n=e.find(".rename-file").attr("data-path");$.ajax({type:"POST",url:"ajax_calls.php?action=get_file&sub_action=edit&preview_mode=text",data:{path:n}}).done(function(r){bootbox.dialog(r,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#textfile_edit_area").val();$.ajax({type:"POST",url:"execute.php?action=save_text_file",data:{path:n,path_thumb:t,new_content:e}}).done(function(e){if(e!=""){bootbox.alert(e)}})}}],{header:e.find(".name_download").val()})})}function change_lang(){$.ajax({type:"POST",url:"ajax_calls.php?action=get_lang",data:{}}).done(function(e){bootbox.dialog(e,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#new_lang_select option:selected").val();$.ajax({type:"POST",url:"ajax_calls.php?action=change_lang",data:{choosen_lang:e}}).done(function(e){if(e!=""){bootbox.alert(e)}else{setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},500)}})}}],{header:$("#lang_lang_change").val()})})}function chmod(e){$("#files_permission_start").parent().parent().remove();if(!e.hasClass("directory")){var t=e.find(".rename-file").attr("data-thumb");var n=e.find(".rename-file").attr("data-path")}else{var t=e.find(".rename-folder").attr("data-thumb");var n=e.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=chmod",data:{path:n,path_thumb:t}}).done(function(e){bootbox.dialog(e,[{label:$("#cancel").val(),"class":"btn"},{label:$("#ok").val(),"class":"btn-inverse",callback:function(){var e=$("#chmod_form #chmod_value").val();if(e!=""&&typeof e!=="undefined"){var r=$("#chmod_form input[name=apply_recursive]:checked").val();if(r==""||typeof r==="undefined"){r="none"}$.ajax({type:"POST",url:"execute.php?action=chmod",data:{path:n,path_thumb:t,new_mode:e,is_recursive:r}}).done(function(e){if(e!=""){bootbox.alert(e)}})}}}],{header:$("#lang_file_permission").val()})})}function chmod_logic(e){var t=[];t["user"]=0;t["group"]=0;t["all"]=0;if(typeof e!=="undefined"&&e==true){var n=$("#chmod_form #chmod_value").val();t["user"]=n.substr(0,1);t["group"]=n.substr(1,1);t["all"]=n.substr(2,1);$.each(t,function(e){if(t[e]==""||$.isNumeric(t[e])==false||parseInt(t[e])<0||parseInt(t[e])>7){t[e]="0"}});$("#chmod_form input:checkbox").each(function(){var e=$(this).attr("data-group");var n=$(this).attr("data-value");if(chmod_logic_helper(t[e],n)){$(this).prop("checked",true)}else{$(this).prop("checked",false)}})}else{$("#chmod_form input:checkbox:checked").each(function(){var e=$(this).attr("data-group");var n=$(this).attr("data-value");t[e]=parseInt(t[e])+parseInt(n)});$("#chmod_form #chmod_value").val(t["user"].toString()+t["group"].toString()+t["all"].toString())}}function chmod_logic_helper(e,t){var n=[];n[1]=[1,3,5,7];n[2]=[2,3,6,7];n[4]=[4,5,6,7];e=parseInt(e);t=parseInt(t);if($.inArray(e,n[t])!=-1){return true}else{return false}}function clear_clipboard(){bootbox.confirm($("#lang_clear_clipboard_confirm").val(),$("#cancel").val(),$("#ok").val(),function(e){if(e==true){$.ajax({type:"POST",url:"ajax_calls.php?action=clear_clipboard",data:{}}).done(function(e){if(e!="")bootbox.alert(e);else $("#clipboard").val("0");toggle_clipboard(false)})}})}function copy_cut_clicked(e,t){if(t!="copy"&&t!="cut"){return}if(!e.hasClass("directory")){var n=e.find(".rename-file").attr("data-thumb");var r=e.find(".rename-file").attr("data-path")}else{var n=e.find(".rename-folder").attr("data-thumb");var r=e.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:r,path_thumb:n,sub_action:t}}).done(function(e){if(e!=""){bootbox.alert(e)}else{$("#clipboard").val("1");toggle_clipboard(true)}})}function paste_to_this_dir(e){bootbox.confirm($("#lang_paste_confirm").val(),$("#cancel").val(),$("#ok").val(),function(t){if(t==true){if(typeof e!="undefined"){var n=e.find(".rename-folder").attr("data-path");var r=e.find(".rename-folder").attr("data-thumb")}else{var n=$("#sub_folder").val()+$("#fldr_value").val();var r=$("#cur_dir_thumb").val()}$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:n,path_thumb:r}}).done(function(e){if(e!=""){bootbox.alert(e)}else{$("#clipboard").val("0");toggle_clipboard(false);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300)}})}})}function drag_n_drop_paste(e,t){if(!e.hasClass("directory")){var n=e.find(".rename-file").attr("data-thumb");var r=e.find(".rename-file").attr("data-path")}else{var n=e.find(".rename-folder").attr("data-thumb");var r=e.find(".rename-folder").attr("data-path")}$.ajax({type:"POST",url:"ajax_calls.php?action=copy_cut",data:{path:r,path_thumb:n,sub_action:"cut"}}).done(function(n){if(n!=""){bootbox.alert(n)}else{if(typeof t!="undefined"){if(t.hasClass("back-directory")){var r=t.find(".path").val();var i=t.find(".path_thumb").val()}else{var r=t.find(".rename-folder").attr("data-path");var i=t.find(".rename-folder").attr("data-thumb")}}else{var r=$("#sub_folder").val()+$("#fldr_value").val();var i=$("#cur_dir_thumb").val()}$.ajax({type:"POST",url:"execute.php?action=paste_clipboard",data:{path:r,path_thumb:i}}).done(function(t){if(t!=""){bootbox.alert(t)}else{$("#clipboard").val("0");toggle_clipboard(false);e.parent().remove()}})}})}function toggle_clipboard(e){if(e==true){$(".paste-here-btn, .clear-clipboard-btn").removeClass("disabled")}else{$(".paste-here-btn, .clear-clipboard-btn").addClass("disabled")}}function fix_colums(e){var t=$(".breadcrumb").width()+e;$(".uploader").css("width",t);if($("#view").val()>0){if($("#view").val()==1){$("ul.grid li, ul.grid figure").css("width","100%")}else{var n=Math.floor(t/380);if(n==0){n=1;$("h4").css("font-size",12)}t=Math.floor(t/n-3);$("ul.grid li, ul.grid figure").css("width",t)}$("#help").hide()}else{if(Modernizr.touch){$("#help").show()}}}function swipe_reaction(e,t,n,r,i){var s=$(this);if($("#view").val()==0){if(s.attr("toggle")==1){s.attr("toggle",0);s.animate({top:"0px"},{queue:false,duration:300})}else{s.attr("toggle",1);s.animate({top:"-30px"},{queue:false,duration:300})}}}function encodeURL(e){var t=e.split("/");for(var n=3;n<t.length;n++){t[n]=encodeURIComponent(t[n])}return t.join("/")}function apply(e,t){if($("#popup").val()==1)var n=window.opener;else var n=window.parent;var r=$("#cur_dir").val();var i=$("#subdir").val();var s=$("#base_url").val();var o=e.substr(0,e.lastIndexOf("."));var u=e.split(".").pop();u=u.toLowerCase();var a="";var f=new Array("ogg","mp3","wav");var l=new Array("mp4","ogg","webm");var c=$("#return_relative_url").val();var h=encodeURL((c==1?i:s+r)+e);if(t!=""){if($("#crossdomain").val()==1){n.postMessage({sender:"responsivefilemanager",url:h,field_id:t},"*")}else{var p=$("#"+t,n.document);p.val(h).trigger("change");if(typeof n.responsive_filemanager_callback=="function"){n.responsive_filemanager_callback(t)}close_window()}}else{if($.inArray(u,ext_img)>-1){a='<img src="'+h+'" alt="'+o+'" />'}else{if($.inArray(u,l)>-1){a='<video controls source src="'+h+'" type="video/'+u+'">'+o+"</video>"}else{if($.inArray(u,f)>-1){if(u=="mp3"){u="mpeg"}a='<audio controls src="'+h+'" type="audio/'+u+'">'+o+"</audio>"}else{a='<a href="'+h+'" title="'+o+'">'+o+"</a>"}}}if($("#crossdomain").val()==1){n.postMessage({sender:"responsivefilemanager",url:h,field_id:null,html:a},"*")}else{if(parent.tinymce.majorVersion<4){parent.tinymce.activeEditor.execCommand("mceInsertContent",false,a);parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)}else{parent.tinymce.activeEditor.insertContent(a);parent.tinymce.activeEditor.windowManager.close()}}}}function apply_link(e,t){if($("#popup").val()==1)var n=window.opener;else var n=window.parent;var r=$("#cur_dir").val();r=r.replace("\\","/");var i=$("#subdir").val();i=i.replace("\\","/");var s=$("#base_url").val();var o=$("#return_relative_url").val();var u=encodeURL((o==1?i:s+r)+e);if(t!=""){if($("#crossdomain").val()==1){n.postMessage({sender:"responsivefilemanager",url:u,field_id:t},"*")}else{var a=$("#"+t,n.document);a.val(u).trigger("change");if(typeof n.responsive_filemanager_callback=="function"){n.responsive_filemanager_callback(t)}close_window()}}else{apply_any(u)}}function apply_img(e,t){if($("#popup").val()==1)var n=window.opener;else var n=window.parent;var r=$("#cur_dir").val();r=r.replace("\\","/");var i=$("#subdir").val();i=i.replace("\\","/");var s=$("#base_url").val();var o=$("#return_relative_url").val();var u=encodeURL((o==1?i:s+r)+e);if(t!=""){if($("#crossdomain").val()==1){n.postMessage({sender:"responsivefilemanager",url:u,field_id:t},"*")}else{var a=$("#"+t,n.document);a.val(u).trigger("change");if(typeof n.responsive_filemanager_callback=="function"){n.responsive_filemanager_callback(t)}close_window()}}else{apply_any(u)}}function apply_video(e,t){if($("#popup").val()==1)var n=window.opener;else var n=window.parent;var r=$("#cur_dir").val();r=r.replace("\\","/");var i=$("#subdir").val();i=i.replace("\\","/");var s=$("#base_url").val();var o=$("#return_relative_url").val();var u=encodeURL((o==1?i:s+r)+e);if(t!=""){if($("#crossdomain").val()==1){n.postMessage({sender:"responsivefilemanager",url:u,field_id:t},"*")}else{var a=$("#"+t,n.document);a.val(u).trigger("change");if(typeof n.responsive_filemanager_callback=="function"){n.responsive_filemanager_callback(t)}close_window()}}else{apply_any(u)}}function apply_none(e,t){var n=$('li[data-name="'+e+'"]').find(".preview");if(n.html()!=""&&n.html()!==undefined){$("#full-img").attr("src",decodeURIComponent(n.attr("data-url")));if(n.hasClass("disabled")==false){show_animation();$("#previewLightbox").lightbox()}}else{var n=$('li[data-name="'+e+'"]').find("a.file-preview-btn");if(n.html()!=""&&n.html()!==undefined){$.ajax({url:n.attr("data-url"),success:function(e){bootbox.alert(e)}})}else{var n=$('li[data-name="'+e+'"]').find(".modalAV");$("#previewAV").removeData("modal");$("#previewAV").modal({backdrop:"static",keyboard:false});if(n.hasClass("audio")){$(".body-preview").css("height","80px")}else{$(".body-preview").css("height","345px")}$.ajax({url:decodeURIComponent(n.attr("data-url")),success:function(e){$(".body-preview").html(e)}})}}return}function apply_any(e){if($("#crossdomain").val()==1){window.parent.postMessage({sender:"responsivefilemanager",url:e,field_id:null},"*")}else{if(parent.tinymce.majorVersion<4){parent.tinymce.activeEditor.windowManager.params.setUrl(e);parent.tinymce.activeEditor.windowManager.close(parent.tinymce.activeEditor.windowManager.params.mce_window_id)}else{parent.tinymce.activeEditor.windowManager.getParams().setUrl(e);parent.tinymce.activeEditor.windowManager.close()}}return false}function close_window(){if($("#popup").val()==1){window.close()}else{if(typeof parent.jQuery!=="undefined"&&parent.jQuery){parent.jQuery("#filemanager").modal("hide")}else{parent.$("#filemanager").modal("hide")}}}function apply_file_duplicate(e,t){var n=e.parent().parent().parent().parent();n.after("<li class='"+n.attr("class")+"' data-name='"+n.attr("data-name")+"'>"+n.html()+"</li>");var r=n.next();apply_file_rename(r.find("figure"),t);var i=r.find(".download-form");var s="form"+(new Date).getTime();i.attr("id",s);i.find(".tip-right").attr("onclick","$('#"+s+"').submit();")}function apply_file_rename(e,t){e.attr("data-name",t);e.parent().attr("data-name",t);e.find("h4").find("a").text(t);var n=e.find("a.link");var r=n.attr("data-file");var i=r.substring(r.lastIndexOf("/")+1);var s=r.substring(r.lastIndexOf(".")+1);n.each(function(){$(this).attr("data-file",encodeURIComponent(t+"."+s))});e.find("img").each(function(){var e=$(this).attr("src");$(this).attr("src",e.replace(i,t+"."+s)+"?time="+(new Date).getTime());$(this).attr("alt",t+" thumbnails")});var o=e.find("a.preview");var r=o.attr("data-url");if(typeof r!=="undefined"&&r){o.attr("data-url",r.replace(encodeURIComponent(i),encodeURIComponent(t+"."+s)))}e.parent().attr("data-name",t+"."+s);e.attr("data-name",t+"."+s);e.find(".name_download").val(t+"."+s);var u=e.find("a.rename-file");var a=e.find("a.delete-file");var f=u.attr("data-path");var l=u.attr("data-thumb");var c=f.replace(i,t+"."+s);var h=l.replace(i,t+"."+s);u.attr("data-path",c);u.attr("data-thumb",h);a.attr("data-path",c);a.attr("data-thumb",h)}function apply_folder_rename(e,t){e.attr("data-name",t);e.find("figure").attr("data-name",t);var n=e.find("h4").find("a").text();e.find("h4 > a").text(t);var r=e.find(".folder-link");var i=r.attr("href");var s=$("#fldr_value").val();var o=i.replace("fldr="+s+encodeURIComponent(n),"fldr="+s+encodeURIComponent(t));r.each(function(){$(this).attr("href",o)});var u=e.find("a.delete-folder");var a=e.find("a.rename-folder");var f=a.attr("data-path");var l=a.attr("data-thumb");var c=f.lastIndexOf("/");var h=f.substr(0,c+1)+t;u.attr("data-path",h);a.attr("data-path",h);var c=l.lastIndexOf("/");var h=l.substr(0,c+1)+t;u.attr("data-thumb",h);a.attr("data-thumb",h)}function replace_last(e,t,n){var r=new RegExp(t+"$");return e.replace(r,n)}function replaceDiacritics(e){var e;var t=[/[\300-\306]/g,/[\340-\346]/g,/[\310-\313]/g,/[\350-\353]/g,/[\314-\317]/g,/[\354-\357]/g,/[\322-\330]/g,/[\362-\370]/g,/[\331-\334]/g,/[\371-\374]/g,/[\321]/g,/[\361]/g,/[\307]/g,/[\347]/g];var n=["A","a","E","e","I","i","O","o","U","u","N","n","C","c"];for(var r=0;r<t.length;r++){e=e.replace(t[r],n[r])}return e}function fix_filename(e){if(e!=null){if($("#transliteration").val()=="true"){e=replaceDiacritics(e);e=e.replace(/[^A-Za-z0-9\.\-\[\]\ \_]+/g,"")}if($("#convert_spaces").val()=="true"){e=e.replace(/ /g,$("#replace_with").val());e=e.toLowerCase()}e=e.replace('"',"");e=e.replace("'","");e=e.replace("/","");e=e.replace("\\","");e=e.replace(/<\/?[^>]+(>|$)/g,"");return $.trim(e)}return null}function execute_action(e,t,n,r,i,s){if(r!==null){r=fix_filename(r);$.ajax({type:"POST",url:"execute.php?action="+e,data:{path:t,path_thumb:n,name:r.replace("/","")}}).done(function(e){if(e!=""){bootbox.alert(e);return false}else{if(s!=""){window[s](i,r)}}return true})}}function sortUnorderedList(e,t,n){if(typeof e=="string")e=$(e);var r=e.find("li.dir");var i=e.find("li.file");var s=[];var o=[];var u=[];var a=[];$.each(r,function(e){var t=$(this);var r=t.find(n).val();if($.isNumeric(r)){r=parseFloat(r);while(typeof s[r]!=="undefined"&&s[r]){r=parseFloat(parseFloat(r)+parseFloat(.001))}}else{r=r+"a"+t.find("h4 a").attr("data-file")}s[r]=t.html();o.push(r)});$.each(i,function(e){var t=$(this);var r=t.find(n).val();if($.isNumeric(r)){r=parseFloat(r);while(typeof u[r]!=="undefined"&&u[r]){r=parseFloat(parseFloat(r)+parseFloat(.001))}}else{r=r+"a"+t.find("h4 a").attr("data-file")}u[r]=t.html();a.push(r)});if($.isNumeric(o[0])){o.sort(function(e,t){return parseFloat(e)-parseFloat(t)})}else{o.sort()}if($.isNumeric(a[0])){a.sort(function(e,t){return parseFloat(e)-parseFloat(t)})}else{a.sort()}if(t){o.reverse();a.reverse()}$.each(r,function(e){var t=$(this);t.html(s[o[e]])});$.each(i,function(e){var t=$(this);t.html(u[a[e]])})}function show_animation(){$("#loading_container").css("display","block");$("#loading").css("opacity",".7")}function hide_animation(){$("#loading_container").fadeOut()}function launchEditor(e,t){featherEditor.launch({image:e,url:t});return false}function lazyLoad(){$(window).trigger("scroll")}var version="9.8.2";var active_contextmenu=true;var copy_count=0;$(document).ready(function(){function r(e){window[e.attr("data-function")](e.attr("data-file"),e.attr("data-field_id"))}if(active_contextmenu){$.contextMenu({selector:"figure:not(.back-directory), .list-view2 figure:not(.back-directory)",autoHide:true,build:function(e){e.addClass("selected");var t={callback:function(t,n){switch(t){case"copy_url":var r=$("#base_url").val()+$("#cur_dir").val();add=e.find("a.link").attr("data-file");if(add!=""&&add!=null){r+=add}add=e.find("h4 a.folder-link").attr("data-file");if(add!=""&&add!=null){r+=add}bootbox.alert('URL:<br/><div class="input-append" style="width:100%"><input id="url_text'+copy_count+'" type="text" style="width:80%; height:30px;" value="'+encodeURL(r)+'" /><button id="copy-button'+copy_count+'" class="btn btn-inverse copy-button" style="width:20%; height:30px;" data-clipboard-target="url_text'+copy_count+'" data-clipboard-text="Copy Me!" title="copy"></button></div>');$("#copy-button"+copy_count).html('<i class="icon icon-white icon-share"></i> '+$("#lang_copy").val());var i=new ZeroClipboard($("#copy-button"+copy_count));i.on("ready",function(e){i.on("wrongFlash noFlash",function(){ZeroClipboard.destroy()});i.on("aftercopy",function(e){$("#copy-button"+copy_count).html('<i class="icon icon-ok"></i> '+$("#ok").val());$("#copy-button"+copy_count).attr("class","btn disabled");copy_count++});i.on("error",function(e){console.log('ZeroClipboard error of type "'+e.name+'": '+e.message)})});break;case"unzip":var r=$("#sub_folder").val()+$("#fldr_value").val()+e.find("a.link").attr("data-file");$.ajax({type:"POST",url:"ajax_calls.php?action=extract",data:{path:r}}).done(function(e){if(e!="")bootbox.alert(e);else window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()});break;case"edit_img":var s=e.attr("data-name");var o=$("#base_url_true").val()+$("#cur_dir").val()+s;$("#aviary_img").attr("data-name",s);$("#aviary_img").attr("src",o).load(launchEditor("aviary_img",o));break;case"duplicate":var u=e.find("h4").text().trim();bootbox.prompt($("#lang_duplicate").val(),$("#cancel").val(),$("#ok").val(),function(t){if(t!==null){t=fix_filename(t);if(t!=u){var n=e.find(".rename-file");execute_action("duplicate_file",n.attr("data-path"),n.attr("data-thumb"),t,n,"apply_file_duplicate")}}},u);break;case"copy":copy_cut_clicked(e,"copy");break;case"cut":copy_cut_clicked(e,"cut");break;case"paste":paste_to_this_dir();break;case"chmod":chmod(e);break;case"edit_text_file":edit_text_file(e);break}},items:{}};if((e.find(".img-precontainer-mini .filetype").hasClass("png")||e.find(".img-precontainer-mini .filetype").hasClass("jpg")||e.find(".img-precontainer-mini .filetype").hasClass("jpeg"))&&image_editor){t.items.edit_img={name:$("#lang_edit_image").val(),icon:"edit_img",disabled:false}}t.items.copy_url={name:$("#lang_show_url").val(),icon:"url",disabled:false};if(e.find(".img-precontainer-mini .filetype").hasClass("zip")||e.find(".img-precontainer-mini .filetype").hasClass("tar")||e.find(".img-precontainer-mini .filetype").hasClass("gz")){t.items.unzip={name:$("#lang_extract").val(),icon:"extract",disabled:false}}if(e.find(".img-precontainer-mini .filetype").hasClass("edit-text-file-allowed")){t.items.edit_text_file={name:$("#lang_edit_file").val(),icon:"edit",disabled:false}}if(!e.hasClass("directory")&&$("#duplicate").val()==1){t.items.duplicate={name:$("#lang_duplicate").val(),icon:"duplicate",disabled:false}}if(!e.hasClass("directory")&&$("#copy_cut_files_allowed").val()==1){t.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:false};t.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:false}}else if(e.hasClass("directory")&&$("#copy_cut_dirs_allowed").val()==1){t.items.copy={name:$("#lang_copy").val(),icon:"copy",disabled:false};t.items.cut={name:$("#lang_cut").val(),icon:"cut",disabled:false}}if($("#clipboard").val()!=0&&!e.hasClass("directory")){t.items.paste={name:$("#lang_paste_here").val(),icon:"clipboard-apply",disabled:false}}if(!e.hasClass("directory")&&$("#chmod_files_allowed").val()==1){t.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:false}}else if(e.hasClass("directory")&&$("#chmod_dirs_allowed").val()==1){t.items.chmod={name:$("#lang_file_permission").val(),icon:"key",disabled:false}}t.items.sep="----";t.items.info={name:"<strong>"+$("#lang_file_info").val()+"</strong>",disabled:true};t.items.name={name:e.attr("data-name"),icon:"label",disabled:true};if(e.attr("data-type")=="img"){t.items.dimension={name:e.find(".img-dimension").html(),icon:"dimension",disabled:true}}t.items.size={name:e.find(".file-size").html(),icon:"size",disabled:true};t.items.date={name:e.find(".file-date").html(),icon:"date",disabled:true};return t},events:{hide:function(e){$("figure").removeClass("selected")}}});$(document).on("contextmenu",function(e){if(!$(e.target).is("figure"))return false})}$("#full-img").on("click",function(){$("#previewLightbox").lightbox("hide")});$("ul.grid").on("click",".modalAV",function(e){_this=$(this);e.preventDefault();$("#previewAV").removeData("modal");$("#previewAV").modal({backdrop:"static",keyboard:false});if(_this.hasClass("audio")){$(".body-preview").css("height","80px")}else{$(".body-preview").css("height","345px")}$.ajax({url:_this.attr("data-url"),success:function(e){$(".body-preview").html(e)}})});$("ul.grid").on("click",".file-preview-btn",function(e){_this=$(this);e.preventDefault();$.ajax({url:_this.attr("data-url"),success:function(e){bootbox.alert(e)}})});$("input[name=radio-sort]").on("click",function(){var e=$(this).attr("data-item");$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#filter-input").val("");$("#"+e).addClass("btn-inverse");$("#"+e).find("i").addClass("icon-white");if(e=="ff-item-type-all"){$(".grid li").show(300)}else{if($(this).is(":checked")){$(".grid li").not("."+e).hide(300);$(".grid li."+e).show(300)}}lazyLoad()});var e=function(){var e=0;return function(t,n){clearTimeout(e);e=setTimeout(t,n)}}();if(parseInt($("#file_number").val())>parseInt($("#file_number_limit_js").val()))var t=false;else var t=true;$("#filter-input").on("keyup",function(){$(".filters label").removeClass("btn-inverse");$(".filters label").find("i").removeClass("icon-white");$("#ff-item-type-all").addClass("btn-inverse");$("#ff-item-type-all").find("i").addClass("icon-white");var n=fix_filename($(this).val());$(this).val(n);e(function(){if(t){$("ul.grid li").each(function(){var e=$(this);if(n!=""&&e.attr("data-name").toString().toLowerCase().indexOf(n.toLowerCase())==-1){e.hide(100)}else{e.show(100)}});lazyLoad();$.ajax({url:"ajax_calls.php?action=filter&type="+n}).done(function(e){if(e!=""){bootbox.alert(e)}})}},300)}).keypress(function(e){if(e.which==13){$("#filter").trigger("click")}});$("#filter").on("click",function(){var e=fix_filename($("#filter-input").val());window.location.href=$("#current_url").val()+"&filter="+e});$("#info").on("click",function(){bootbox.alert('<div class="text-center"><br/><img src="img/logo.png" alt="responsive filemanager"/><br/><br/><p><strong>RESPONSIVE filemanager v.'+version+'</strong><br/><a href="http://www.responsivefilemanager.com">responsivefilemanager.com</a></p><br/><p>Copyright © <a href="http://www.tecrail.com" alt="tecrail">Tecrail</a> - Alberto Peripolli. All rights reserved.</p><br/><p>License<br/><small><img alt="Creative Commons License" style="border-width:0" src="http://responsivefilemanager.com/license.php" /><br />This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</small></p></div>')});$("#change_lang_btn").on("click",function(){change_lang()});$("#uploader-btn").on("click",function(){var e=$("#sub_folder").val()+$("#fldr_value").val()+"/";e=e.substring(0,e.length-1);$("#iframe-container").html($("<iframe />",{name:"JUpload",id:"uploader_frame",src:"uploader/index.php?path="+e,frameborder:0,width:"100%",height:360}))});$(".upload-btn").on("click",function(){$(".uploader").show(500)});var n=$("#descending").val();$(".sorter").on("click",function(){_this=$(this);if($("#sort_by").val()===_this.attr("data-sort")){if(n==0)n=true;else n=false}else{n=true}if(t){$.ajax({url:"ajax_calls.php?action=sort&sort_by="+_this.attr("data-sort")+"&descending="+(n?1:0)});sortUnorderedList("ul.grid",n,"."+_this.attr("data-sort"));$(" a.sorter").removeClass("descending").removeClass("ascending");if(n)$(".sort-"+_this.attr("data-sort")).addClass("descending");else $(".sort-"+_this.attr("data-sort")).addClass("ascending");$("#sort_by").val(_this.attr("data-sort"));$("#descending").val(n?1:0);lazyLoad()}else{window.location.href=$("#current_url").val()+"&sort_by="+_this.attr("data-sort")+"&descending="+(n?1:0)}});$(".close-uploader").on("click",function(){$(".uploader").hide(500);setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},420)});$("ul.grid").on("click",".preview",function(){var e=$(this);$("#full-img").attr("src",decodeURIComponent(e.attr("data-url")));if(e.hasClass("disabled")==false){show_animation()}return true});$("body").on("keypress",function(e){var t=String.fromCharCode(e.which);if(t=="'"||t=='"'||t=="\\"||t=="/"){return false}});$("ul.grid").on("click",".rename-file",function(){var e=$(this);var t=e.parent().parent().parent();var n=t.find("h4");var r=$.trim(n.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(n){if(n!==null){n=fix_filename(n);if(n!=r){execute_action("rename_file",e.attr("data-path"),e.attr("data-thumb"),n,t,"apply_file_rename")}}},r)});$("ul.grid").on("click",".rename-folder",function(){var e=$(this);var t=e.parent().parent().parent();var n=t.find("h4");var r=$.trim(n.text());bootbox.prompt($("#rename").val(),$("#cancel").val(),$("#ok").val(),function(n){if(n!==null){n=fix_filename(n).replace(".","");if(n!=r){execute_action("rename_folder",e.attr("data-path"),e.attr("data-thumb"),n,t,"apply_folder_rename")}}},r)});$("ul.grid").on("click",".delete-file",function(){var e=$(this);bootbox.confirm(e.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(t){if(t==true){execute_action("delete_file",e.attr("data-path"),e.attr("data-thumb"),"","","");e.parent().parent().parent().parent().remove()}})});$("ul.grid").on("click",".delete-folder",function(){var e=$(this);bootbox.confirm(e.attr("data-confirm"),$("#cancel").val(),$("#ok").val(),function(t){if(t==true){execute_action("delete_folder",e.attr("data-path"),e.attr("data-thumb"),"","","");e.parent().parent().parent().remove()}})});$(".create-file-btn").on("click",function(){create_text_file()});$(".new-folder").on("click",function(){bootbox.prompt($("#insert_folder_name").val(),$("#cancel").val(),$("#ok").val(),function(e){if(e!==null){e=fix_filename(e).replace(".","");var t=$("#sub_folder").val()+$("#fldr_value").val()+e;var n=$("#cur_dir_thumb").val()+e;$.ajax({type:"POST",url:"execute.php?action=create_folder",data:{path:t,path_thumb:n}}).done(function(e){setTimeout(function(){window.location.href=$("#refresh").attr("href")+"&"+(new Date).getTime()},300)})}},$("#new_folder").val())});$(".view-controller button").on("click",function(){var e=$(this);$(".view-controller button").removeClass("btn-inverse");$(".view-controller i").removeClass("icon-white");e.addClass("btn-inverse");e.find("i").addClass("icon-white");$.ajax({url:"ajax_calls.php?action=view&type="+e.attr("data-value")}).done(function(e){if(e!=""){bootbox.alert(e)}});if(typeof $("ul.grid")[0]!=="undefined"&&$("ul.grid")[0])$("ul.grid")[0].className=$("ul.grid")[0].className.replace(/\blist-view.*?\b/g,"");if(typeof $(".sorter-container")[0]!=="undefined"&&$(".sorter-container")[0])$(".sorter-container")[0].className=$(".sorter-container")[0].className.replace(/\blist-view.*?\b/g,"");var t=e.attr("data-value");$("#view").val(t);$("ul.grid").addClass("list-view"+t);$(".sorter-container").addClass("list-view"+t);if(e.attr("data-value")>=1){fix_colums(14)}else{$("ul.grid li").css("width",126);$("ul.grid figure").css("width",122)}lazyLoad()});if(!Modernizr.touch){$(".tip").tooltip({placement:"bottom"});$(".tip-top").tooltip({placement:"top"});$(".tip-left").tooltip({placement:"left"});$(".tip-right").tooltip({placement:"right"});$("body").addClass("no-touch")}else{$("#help").show();$(".box:not(.no-effect)").swipe({swipeLeft:swipe_reaction,swipeRight:swipe_reaction,threshold:30})}$(".paste-here-btn").on("click",function(){if($(this).hasClass("disabled")==false){paste_to_this_dir()}});$(".clear-clipboard-btn").on("click",function(){if($(this).hasClass("disabled")==false){clear_clipboard()}});if(!Modernizr.csstransforms){$("figure").on("mouseover",function(){if($("#view").val()==0&&$("#main-item-container").hasClass("no-effect-slide")===false){$(this).find(".box:not(.no-effect)").animate({top:"-26px"},{queue:false,duration:300})}});$("figure").on("mouseout",function(){if($("#view").val()==0){$(this).find(".box:not(.no-effect)").animate({top:"0px"},{queue:false,duration:300})}})}$(window).resize(function(){fix_colums(28)});fix_colums(14);$("ul.grid .link").on("click",function(){r($(this))});$("ul.grid div.box").on("click",function(e){var t=$(this).find(".link");if(t.length!==0){r(t)}else{var n=$(this).find(".folder-link");if(n.length!==0)document.location=$(n).prop("href")}});if($("#clipboard").val()==1){toggle_clipboard(true)}else{toggle_clipboard(false)}$("li.dir, li.file").draggable({distance:20,cursor:"move",helper:function(){$(this).find("figure").find(".box").css("top","0px");var e=$(this).clone().css("z-index",1e3).find(".box").css("box-shadow","none").css("-webkit-box-shadow","none").parent().parent();$(this).addClass("selected");return e},start:function(){if($("#view").val()==0){$("#main-item-container").addClass("no-effect-slide")}},stop:function(){$(this).removeClass("selected");if($("#view").val()==0){$("#main-item-container").removeClass("no-effect-slide")}}});$("li.dir,li.back").droppable({accept:"ul.grid li",activeClass:"ui-state-highlight",hoverClass:"ui-state-hover",drop:function(e,t){drag_n_drop_paste(t.draggable.find("figure"),$(this).find("figure"))}});$(document).on("keyup","#chmod_form #chmod_value",function(){chmod_logic(true)});$(document).on("focusout","#chmod_form #chmod_value",function(){var e=$("#chmod_form #chmod_value").val();if(e.match(/^[0-7]{3}$/)==null){var t=$("#chmod_form #chmod_value").attr("data-def-value");$("#chmod_form #chmod_value").val(t);chmod_logic(true)}})})